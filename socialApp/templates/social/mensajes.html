{%extends "social/base.html"%}
{% load static %}
{%block head_content%}

<!-- Bootstrap core CSS-->
<link rel="stylesheet" href="{% static 'vendor/bootstrap/css/bootstrap.min.css' %}">
<!-- Custom fonts for this template-->
<link rel="stylesheet" type="text/css" href="{% static 'vendor/fontawesome-free/css/all.min.css' %}">
<script type = "text/javascript" src = "https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script type = "text/javascript" src = "https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.3/jquery-ui.min.js"></script>

<!-- ESTO ES LO QUE DEBERIA DE FUNCIONAR -->

 <title>The jQuery Example</title>
      <script type = "text/javascript" src = "https://code.jquery.com/jquery-2.2.4.min.js"></script>
      <script type = "text/javascript" src = "https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.3/jquery-ui.min.js"></script>
		
      <script type = "text/javascript" language = "javascript">
	       $(document).ready(function() {
      		$(".contact").effect("highlight", {}, 2000);    
  		 });
	</script> 


<!--HASTA AQUI-->
{%endblock%}

{%block container%}
<div id="frame">
  <div id="sidepanel">
    <div id="profile">
      <div class="wrap">
        <img id="profile-img" src="http://www.baytekgames.com/wp-content/uploads/2016/12/facebook-default-no-profile-pic1.jpg" class="online" alt="" />
        <p>Derlis D&aacute;valos</p>
        <i class="fa fa-chevron-down expand-button" aria-hidden="true"></i>
        <div id="status-options">
          <ul>
            <li id="status-online" class="active"><span class="status-circle"></span> <p>Online</p></li>
            <li id="status-away"><span class="status-circle"></span> <p>Lejos</p></li>
            <li id="status-busy"><span class="status-circle"></span> <p>Ocupado</p></li>
            <li id="status-offline"><span class="status-circle"></span> <p>Fuera de LÃ­nea</p></li>
          </ul>
        </div>
        <div id="expanded">
          <label for="twitter"><i class="fa fa-facebook fa-fw" aria-hidden="true"></i></label>
          <input name="twitter" type="text" value="mikeross" />
          <label for="twitter"><i class="fa fa-twitter fa-fw" aria-hidden="true"></i></label>
          <input name="twitter" type="text" value="ross81" />
          <label for="twitter"><i class="fa fa-instagram fa-fw" aria-hidden="true"></i></label>
          <input name="twitter" type="text" value="mike.ross" />
        </div>
      </div>
    </div>
    <div id="search">
      <label for=""><i class="fa fa-search" aria-hidden="true"></i></label>
      <input type="text" placeholder="Buscar contactos..." />
    </div>
     <div id="contacts">
	  <div id="contacts_content"></div>
	   <script>
		function updateCnts() {
  			$.ajax({
    				url: "{%url 'list_conversations'%}",
    				success: function(response){
      				$("#contacts_content").html(response);
    				}
   			});
   			setTimeout('updateCnts()', 5000);
			}
		updateCnts(); 
	    </script> 	         
    </div>
    <div id="bottom-bar">
      <button id="addcontact"><i class="fa fa-user-plus fa-fw" aria-hidden="true"></i> <span>Agregar contacto</span></button>
      <button id="settings"><i class="fa fa-cog fa-fw" aria-hidden="true"></i> <span>Configuraci&oacute;n</span></button>
    </div>
  </div>
  <div class="content">
    <div id="contact-profile"></div>
	  
    <div id="messages_container"></div>
	 
    <div class="message-input">
      <div class="wrap">
        <form method="POST" action="#" id="formConversation">
        <input type="text" name="text" placeholder="Escriba su mensaje..." autocomplete="off" />
        <i class="fa fa-paperclip attachment" aria-hidden="true"></i>
        <button class="submit"><i class="fa fa-paper-plane" aria-hidden="true"></i></button>
        </form> 
      </div>
    </div>
  </div>
 		  
	
</div>
<!--script src='//production-assets.codepen.io/assets/common/stopExecutionOnTimeout-b2a7b3fe212eaa732349046d8416e00a9dec26eb7fd347590fbced3ab38af52e.js'></script-->
<script>                                                                          
function display_message(conver_pk){
  var parametros = {
    "conversation_id":conver_pk
  };	
  $.ajax({
    data: parametros,
    url:"{%url 'show_contact'%}",
    type: 'post',
    success: function(response){
      $("#contact-profile").html(response);
    },  
  });
 	
  $.ajax({
    data: parametros,
    url:"{%url 'display_messages'%}",
    type: 'post',
    beforeSend: function() {
       $("#messages_container").html("<div class='col-12'><img src='{% static 'img/loading-icon.gif' %}'/><div>");
    },
    success: function(response){
      $("#messages_container").html(response);
    },
  }); 
    setTimeout('display_message(conver_pk)', 5000);	
	
}
</script>
<script>
$(".messages").animate({ scrollTop: $(document).height() }, "fast");
$("#profile-img").click(function() {
  $("#status-options").toggleClass("active");
});

$(".expand-button").click(function() {
  $("#profile").toggleClass("expanded");
  $("#contacts").toggleClass("expanded");
});

$("#status-options ul li").click(function() {
  $("#profile-img").removeClass();
  $("#status-online").removeClass("active");
  $("#status-away").removeClass("active");
  $("#status-busy").removeClass("active");
  $("#status-offline").removeClass("active");
  $(this).addClass("active");
  
    if($("#status-online").hasClass("active")) {
    $("#profile-img").addClass("online");
  } else if ($("#status-away").hasClass("active")) {
    $("#profile-img").addClass("away");
  } else if ($("#status-busy").hasClass("active")) {
    $("#profile-img").addClass("busy");
  } else if ($("#status-offline").hasClass("active")) {
    $("#profile-img").addClass("offline");
  } else {
    $("#profile-img").removeClass();
  };
    
  $("#status-options").removeClass("active");
});
  
$("#contacts ul li").click(function(){
  $("#contacts ul li").removeClass("active");
  $(this).addClass("active");
});  
   
      
</script>


{%endblock%}
