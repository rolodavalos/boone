{% load static %} 
<ul>
        {%for conver in conversations%}
	<script>
	var parametros = {
    	"conversation_id":conver.pk
  	};
 	$.ajax({
   	 data: parametros,
   	 url:"{%url 'display_messages'%}",
    	type: 'post',	 
    	beforeSend: function() {
      	 $("#messages_container").html("<div class='col-12'><img src='{% static 'img/loading-icon.gif' %}'/><div>");
    	},
    	success: function(response){
     	 $("#messages_container").html(response);    
    	},
  	}); 	
	</script>	
	 <li class="contact" onclick="display_message({{conver.pk}})">  
              <div class="wrap">
		  {%if conver.estado == 1%}
	       		<span class="contact-status busy"></span>
          	  {%else%}
              		 <span class="contact-status online"></span> 
          	  {%endif%}    
                  <img src="{% static 'img/whatsapp.png' %}" alt="" />
                  <div class="meta">
                    <p class="name">{{conver.contact_uid}}</p>
                    <p class="preview">Disponible.</p>
                  </div>
             </div>
          </li>
        {%endfor%}
      </ul>
<script>
function display_message(conver_pk){
  var parametros = {
    "conversation_id":conver_pk
  };	
  $.ajax({
    data: parametros,
    url:"{%url 'show_contact'%}",
    type: 'post',
    success: function(response){
      $("#contact-profile").html(response);
    },  
  });
 update_messages(conver_pk);  	
}
	
function update_messages(conver_pk){	
var parametros = {
    "conversation_id":conver_pk
  };
 $.ajax({
    data: parametros,
    url:"{%url 'display_messages'%}",
    type: 'post',	 
    beforeSend: function() {
       $("#messages_container").html("<div class='col-12'><img src='{% static 'img/loading-icon.gif' %}'/><div>");
    },
    success: function(response){
      $("#messages_container").html(response);    
    },
  }); 			
setTimeout('update_messages()', 5000);
}	
</script>	
